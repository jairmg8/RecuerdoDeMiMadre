<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Grupo 4 UTP boostrap HTML">
    <title>Recuerdo de mi Madre</title>
    <!-- NO cargar color-modes.js aquí -->
    <link href="./css/bootstrap.min.css" rel="stylesheet" />
    <meta name="theme-color" content="#712cf9" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>
    <link href="./css/topbar.css" rel="stylesheet"/>
    <link href="/css/clientes.css" rel="stylesheet">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }
      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
      .b-example-divider {
        width: 100%;
        height: 3rem;
        background-color: #0000001a;
        border: solid rgba(0, 0, 0, 0.15);
        border-width: 1px 0;
        box-shadow:
          inset 0 0.5em 1.5em #0000001a,
          inset 0 0.125em 0.5em #00000026;
      }
      .b-example-vr {
        flex-shrink: 0;
        width: 1.5rem;
        height: 100vh;
      }
      .bi {
        vertical-align: -0.125em;
        fill: currentColor;
      }
      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }
      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }
      .btn-bd-primary {
        --bd-violet-bg: #e2243b;
        --bd-violet-rgb: 112.520718, 44.062154, 249.437846;
        --bs-btn-font-weight: 600;
        --bs-btn-color: var(--bs-white);
        --bs-btn-bg: var(--bd-violet-bg);
        --bs-btn-border-color: var(--bd-violet-bg);
        --bs-btn-hover-color: var(--bs-white);
        --bs-btn-hover-bg: #e2243b;
        --bs-btn-hover-border-color: #e2243b;
        --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
        --bs-btn-active-color: var(--bs-btn-hover-color);
        --bs-btn-active-bg: #e2243b;
        --bs-btn-active-border-color: #e2243b;
      }
      .bd-mode-toggle {
        z-index: 1500;
      }
      .bd-mode-toggle .bi {
        width: 1em;
        height: 1em;
      }
      .bd-mode-toggle .dropdown-menu .active .bi {
        display: block !important;
      }
    </style>
  </head>
  <body>
    <div id="svg-symbols"></div>
    <div id="theme-toggle"></div>
    <div id="header"></div>
    <main>
      <div id="home-content">
        <div id="hero"></div>
        <div id="features"></div>
      </div>

       <!-- Contenedor para contenido dinámico -->
      <div id="main-content" style="display: none;">
        <!-- Aquí se cargará el contenido dinámico -->
      </div>
    </main>
    <div id="footer"></div>

     <!-- Script para navegación SPA -->
    <script>
      // Sistema de navegación dinámica
      const mainContent = document.getElementById('main-content');
      const homeContent = document.getElementById('home-content');
      let currentScript = null;
      let currentStylesheet = null;

      async function loadPage(page) {
        try {
          // Mostrar contenedor dinámico, ocultar home
          mainContent.style.display = 'block';
          homeContent.style.display = 'none';

          // Limpiar script anterior
          if (currentScript) {
            currentScript.remove();
            currentScript = null;
          }

          // Limpiar stylesheet anterior
          if (currentStylesheet) {
            currentStylesheet.remove();
            currentStylesheet = null;
          }

          // Cargar el HTML
          const response = await fetch(page);
          if (!response.ok) throw new Error('Página no encontrada');
          
          const html = await response.text();
          mainContent.innerHTML = html;

          // Extraer y cargar CSS si existe en el HTML
          const cssMatch = html.match(/<link[^>]*href=["']([^"']*\.css)["'][^>]*>/);
          if (cssMatch) {
            const cssPath = cssMatch[1];
            currentStylesheet = document.createElement('link');
            currentStylesheet.rel = 'stylesheet';
            currentStylesheet.href = cssPath;
            document.head.appendChild(currentStylesheet);
          }

          // Extraer y ejecutar JS si existe en el HTML
          const scriptMatch = html.match(/<script[^>]*src=["']([^"']*\.js)["'][^>]*>/);
          if (scriptMatch) {
            const scriptPath = scriptMatch[1];
            currentScript = document.createElement('script');
            currentScript.src = scriptPath;
            currentScript.defer = true;
            document.body.appendChild(currentScript);
          }

          // Cerrar offcanvas en mobile
          const offcanvas = bootstrap.Offcanvas.getInstance(document.getElementById('offcanvas'));
          if (offcanvas) offcanvas.hide();

        } catch (error) {
          console.error('Error al cargar la página:', error);
          mainContent.innerHTML = `
            <div class="container mt-5">
              <div class="alert alert-danger" role="alert">
                <h4 class="alert-heading">Error al cargar la página</h4>
                <p>No se pudo cargar el contenido solicitado.</p>
              </div>
            </div>
          `;
        }
      }

      function goHome() {
        mainContent.style.display = 'none';
        homeContent.style.display = 'block';
        
        // Limpiar script y stylesheet
        if (currentScript) {
          currentScript.remove();
          currentScript = null;
        }
        if (currentStylesheet) {
          currentStylesheet.remove();
          currentStylesheet = null;
        }
      }

      // Interceptar clics en enlaces del navbar
      document.addEventListener('click', (e) => {
        const link = e.target.closest('a.nav-link');
        if (link && link.getAttribute('href')?.includes('.html')) {
          e.preventDefault();
          const page = link.getAttribute('href');
          loadPage(page);
        } else if (link && link.getAttribute('href') === '#') {
          e.preventDefault();
          goHome();
        }
      });

      // Manejar el logo para volver al home
      document.addEventListener('click', (e) => {
        if (e.target.closest('.navbar-brand')) {
          e.preventDefault();
          goHome();
        }
      });
    </script>
    
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/index.js"></script>
    <script src="js/color-modes.js"></script>
    <script src="/js/clientes.js" defer></script> 
  </body>
</html>